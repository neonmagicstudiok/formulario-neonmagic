
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Formulario NeonMagic</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 2rem; background-color: #111; color: #fff; }
    form { max-width: 500px; margin: auto; background: #222; padding: 2rem; border-radius: 8px; }
    input, textarea, select, button {
      display: block; width: 100%; margin-top: 1rem; padding: 0.7rem;
      border: none; border-radius: 4px;
    }
    button { background-color: #0ff; color: #000; font-weight: bold; cursor: pointer; }
    .status { margin-top: 1rem; font-weight: bold; }
  </style>
</head>
<body>
  <h1>Formulario de Pedido - NeonMagic</h1>
  <form id="pedidoForm">
    <input type="text" name="TextoCartel" placeholder="Texto del cartel" required />
    <input type="text" name="TamañoCartel" placeholder="Tamaño del cartel" required />
    <input type="text" name="MaterialCartel" placeholder="Material" required />
    <input type="text" name="NombreCliente" placeholder="Nombre del cliente" required />
    <input type="email" name="EmailCliente" placeholder="Email del cliente" required />
    <input type="tel" name="Teléfono" placeholder="Teléfono" />
    <textarea name="Comentarios" placeholder="Comentarios adicionales"></textarea>
    <input type="file" name="Foto" accept="image/*" />
    <button type="submit">Enviar pedido</button>
    <div class="status" id="statusMessage"></div>
  </form>

  <script>
    const form = document.getElementById('pedidoForm');
    const status = document.getElementById('statusMessage');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      status.textContent = "Enviando...";

      const formData = new FormData(form);
      const file = formData.get("Foto");

      let fotoBase64 = "";
      if (file && file.size > 0) {
        const reader = new FileReader();
        reader.onloadend = async () => {
          fotoBase64 = reader.result.split(",")[1];
          await enviarDatos(fotoBase64);
        };
        reader.readAsDataURL(file);
      } else {
        await enviarDatos("");
      }

      async function enviarDatos(fotoBase64) {
        const data = {
          TextoCartel: formData.get("TextoCartel"),
          TamañoCartel: formData.get("TamañoCartel"),
          MaterialCartel: formData.get("MaterialCartel"),
          NombreCliente: formData.get("NombreCliente"),
          EmailCliente: formData.get("EmailCliente"),
          Teléfono: formData.get("Teléfono"),
          Comentarios: formData.get("Comentarios"),
          FotoBase64: fotoBase64
        };

        try {
          const response = await fetch("https://script.google.com/macros/s/AKfycbxZKT1itLNv7pU-URL_REAL/exec", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data),
          });

          const result = await response.json();
          if (result.success) {
            status.textContent = "¡Pedido enviado con éxito!";
            setTimeout(() => {
              window.location.href = "https://instagram.com/neonmagicok";
            }, 2000);
          } else {
            status.textContent = "Error al enviar el pedido. Verificá tu conexión.";
          }
        } catch (error) {
          console.error("Error:", error);
          status.textContent = "Error al enviar el pedido. Verificá tu conexión.";
        }
      }
    });
  </script>
</body>
</html>
